---
title: "Empirical Exercise - E3.2"
author: "Chi-Yuan Fang"
date: "`r Sys.Date()`"
output:
  html_document:
    number_sections: yes
    toc: yes
  pdf_document:
    toc: yes

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#library(kableExtra)
```

```{r packages, include=FALSE}
library(openintro)
library(tidyverse)
data(COL)
```




> A consumer is given the chance to buy a baseball card for $1, but he declines
the trade. If the consumer is now given the baseball card, will he be willing to sell it for \$1? Standard consumer theory suggests yes, but behavioral economists have found that “ownership” tends to increase the value of goods to
consumers. That is, the consumer may hold out for some amount more than
\$1 (for example, \$1.20) when selling the card, even though he was willing
to pay only some amount less than \$1 (for example, \$0.88) when buying it.
Behavioral economists call this phenomenon the "endowment effect." John
List investigated the endowment effect in a randomized experiment involving
sports memorabilia traders at a sports-card show. Traders were randomly
given one of two sports collectibles, say good A or good B, that had approximately equal market value. Those receiving good A were then given the
option of trading good A for good B with the experimenter; those receiving
good B were given the option of trading good B for good A with the
experimenter. Data from the experiment and a detailed description can be
found on the text website, **http://www.pearsonglobaleditions.com**, in the files **Sportscards and Sportscards_Description**.

> a. 
>    i. Suppose that, absent any endowment effect, all the subjects prefer good A to good B. What fraction of the experiment’s subjects would you expect to trade the good that they were given for the other good? (Hint:
Because of random assignment of the two treatments, approximately 50\% of the subjects received good A, and 50% received good B.)
>    ii. Suppose that, absent any endowment effect, 50% of the subjects prefer good A to good B, and the other 50% prefer good B to good A. What fraction of the subjects would you expect to trade the good they were given for the other good?
>    iii. Suppose that, absent any endowment effect, $X\%$ of the subjects prefer good A to good B, and the other $(100 - X)\%$ prefer good B to good A. Show that you would expect 50\% of the subjects to trade the good they were given for the other good.

**Solution**

i. A person will trade if he/she received good A but prefers good B or he/she received good B and prefers good A. 50\% received good A, of these $100\%$ prefer good B; 50\% receive good B, of these $0\%$ prefer good A. Thus, the expected fraction traded is 
\begin{align}
0.5 \times 1 + 0.5\times 0 = 0.5.
\end{align}

ii. A person will trade if he/she received good A but prefers good B or he/she received good B and prefers good A. 50\% received good A, of these $50\%$ prefer good B; 50\% receive good B, of these $50\%$ prefer good A. Thus, the expected fraction traded is 
\begin{align}
0.5 \times 0.5 + 0.5\times 0.5 = 0.5.
\end{align}

iii. A person will trade if he/she received good A but prefers good B or he/she received good B and prefers good A. 50\% received good A, of these $(100-X)\%$ prefer good B; 50\% receive good B, of these $X\%$ prefer good A. Thus, the expected fraction traded is 
\begin{align}
0.5 \times (1-x) + 0.5x = 0.5
\end{align}
where $x = \frac{X}{100}$.


> b. Using the sports-card data, what fraction of the subjects traded the good they were given? Is the fraction significantly different from 50\%? Is there evidence of an endowment effect? (Hint: Review Exercises 3.2 and 3.3.)

**Solution**

* **Prepare**

$H_0: p= 0.5$ (no endowment effect) v.s. $H_A: p \neq 0.5$ (endowment effect), where $p$ is the fraction of trades.

Let the significance level be $0.05$.

* **Calculate**

```{r}
# import data 
library(readxl)
sportscards <- read_xlsx("sportscards/Sportscards.xlsx")

E32b <- function(x){
  # mean
  mu <- mean(x)
  # standard deviation
  SD <- sd(x)
  # n
  n <- length(x)
  
  # standard error
  se <- SD / sqrt(n)
  
  Table <- data.frame(mu, se)
  colnames(Table) <- c("Mean", "Standard Error")
  
  Table
} 

# the fraction of trades
E32b(sportscards$trade)

# test
t.test(sportscards$trade, 
       alternative = c("two.sided"),
       mu = 0.5, # H0
       conf.level = 0.95) # alpha = 0.05
```

* **Conclude**

The fraction of trades in the sample was 0.3378, with a standard error of 0.0390. 

Because $p-value < 0.05$, we reject $H_0$. There is statistically significant evidence of an endowment effect.

> c. Some have argued that the endowment effect may be present but that it is likely to disappear as traders gain more trading experience. Half of the experimental subjects were dealers, and the other half were nondealers. Dealers have more experience than nondealers. Repeat (b) for dealers and nondealers. Is there a significant difference in their behavior? Is the evidence consistent with the hypothesis that the endowment effect disappears as traders gain more experience? (Hint: Review Exercise 3.15.)

**Solution**

i. Dealers:

* **Prepare**

$H_0: p_1 = 0.5$ (no endowment effect) v.s. $H_A: p_1 \neq 0.5$ (endowment effect), where $p_1$ is the fraction of trades for dealers.

Let the significance level be $0.05$.

* **Calculate**

```{r}
# data: dealer
sportscards_dealer <- sportscards[sportscards$dealer == 1,]

# the fraction of trades for dealers
E32b(sportscards_dealer$trade)

# test
t.test(sportscards_dealer$trade, 
       alternative = c("two.sided"),
       mu = 0.5, # H0
       conf.level = 0.95) # alpha = 0.05
```

* **Conclude**

The fraction of trades for dealers in the sample was 0.4459, with a standard error of 0.05818. 

Because $p-value > 0.05$, we do not reject $H_0$. There is no evidence of an endowment effect.

ii. Nondealers:

* **Prepare**

$H_0: p_2 = 0.5$ (no endowment effect) v.s. $H_A: p_2 \neq 0.5$ (endowment effect), where $p_2$ is the fraction of trades for nondealers.

Let the significance level be $0.05$.

* **Calculate**

```{r}
# data: nondealer 
sportscards_nondealer <- sportscards[sportscards$dealer == 0,]

# the fraction of trades for nondealers
E32b(sportscards_nondealer$trade)

# test
t.test(sportscards_nondealer$trade, 
       alternative = c("two.sided"),
       mu = 0.5, # H0
       conf.level = 0.95) # alpha = 0.05
```

* **Conclude**

The fraction of trades for nondealers in the sample was 0.2297, with a standard error of 0.0492. 

Because $p-value < 0.05$, we reject $H_0$. There is statistically significant evidence of an endowment effect.

iii. Difference between dealers and nondealers:

* **Prepare**

$H_0: p_1 - p_2 = 0$ v.s. $H_A: p_1 - p_2 \neq 0$, where $p_1$ is the fraction of trades for dealers, and $p_2$ is the fraction of trades for nondealers.

Let the significance level be $0.05$.

* **Calculate**

```{r}
E32ciii <- function(x1, x2){
  # mean
  mu1 <- mean(x1); mu2 <- mean(x2)
  
  # s
  SD1 <- sd(x1); SD2 <- sd(x2)
  
  # n
  n1 <- length(x1); n2 <- length(x2)
  
  # difference in mean
  mu <- mu2 - mu1
  
  # difference in standard error
  se <- sqrt(SD1^2/n1 + SD2^2/n2)
  
  Table <- data.frame(mu, se)
  colnames(Table) <- c("Mean", "Standard Error")
  
  Table  
  
}

E32ciii(sportscards_dealer$trade, sportscards_nondealer$trade)

t.test(sportscards_dealer$trade, sportscards_nondealer$trade, 
       alternative = c("two.sided"),
       mu = 0, # H0
       var.equal = FALSE,
       conf.level = 0.95) # alpha = 0.05

```

* **Conclude**

Because $p-value < 0.05$, we reject $H_0$. There is statistically significant difference in the behavior of Traders and non-Traders.

